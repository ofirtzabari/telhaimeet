<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Firebase Hosting</title>

    <script defer src="/__/firebase/9.17.1/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/9.17.1/firebase-auth-compat.js"></script>
    <script defer src="/__/firebase/9.17.1/firebase-database-compat.js"></script>
    <script defer src="/__/firebase/9.17.1/firebase-firestore-compat.js"></script>
    <script defer src="/__/firebase/9.17.1/firebase-functions-compat.js"></script>
    <script defer src="/__/firebase/9.17.1/firebase-messaging-compat.js"></script>
    <script defer src="/__/firebase/9.17.1/firebase-storage-compat.js"></script>
    <script defer src="/__/firebase/9.17.1/firebase-analytics-compat.js"></script>
    <script defer src="/__/firebase/9.17.1/firebase-remote-config-compat.js"></script>
    <script defer src="/__/firebase/9.17.1/firebase-performance-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-auth.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <!-- <script type="module" src="signup.js"></script>  -->
    <style>
      body{
        background-color:#64a83abe ;
      }
      
    </style>
  </head>
  <body>
    <div class="container mt-3">
        <h2 class="text-center">fill details and preferences</h2>
        <form>
          <div class="form-group">
            <label class="mt-2" for="firstName">First Name:</label>
            <input type="text" class="form-control" id="firstName" placeholder="Enter first name" required/>
          </div>
          <div class="form-group">
            <label class="mt-2" for="birthDate">Birth Date:</label>
            <input type="date" class="form-control" id="birthDate" required/>
          </div>
          <div class="form-group">
            <label class="mt-2" for="gender">What am I?</label>
            <select class="form-control" id="gender" required>
              <option>Male</option>
              <option>Female</option>
              <option>Other</option>
            </select>
          </div>
          <div class="form-group">
            <label class="mt-2" for="searchGender">What I am searching for?</label>
            <select class="form-control" id="searchGender" required>
              <option>Male</option>
              <option>Female</option>
              <option>Both</option>
            </select>
          </div>
        </form>
        <button id="submit" class="btn btn-primary mt-2">Submit</button>
      </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js'
        import { getFirestore, doc, setDoc } from 'https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js'
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js'

        const firebaseConfig = {
            apiKey: "AIzaSyBpnxrWY7cxJ3jAPceUju5C5lcxiDpot6I",
            authDomain: "meetelhai.firebaseapp.com",
            databaseURL: "https://meetelhai-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "meetelhai",
            storageBucket: "meetelhai.appspot.com",
            messagingSenderId: "690174653337",
            appId: "1:690174653337:web:7fad7656f5466c1e235908"
        };
    
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const db = getFirestore(app);

        $(document).ready(()=>{
          $("#submit").click(()=>{
            onAuthStateChanged(auth, (user) => {
              if (user) {
                var name = $("#firstName").val();
                var birthDate = $("#birthDate").val();
                var gender_ = $("#gender").val();
                var searchGender = $("#searchGender").val();
                const myData = doc(db, 'Who-I-Am', user.email);
                setDoc(myData, {first_name: name, birth : birthDate, gender : gender_, search : searchGender});
                alert(name+ " " + birthDate + " " + gender_ + " " + searchGender)
                window.location.href="./main.html";
              } 
              else {
                alert("you are log out, please log in");
                window.location.href="./login.html";
              }
            });
          });
        });
        
        
    </script>
</body>
</html>
